{
  "hash": "da2017322d41ad1e5f272903a29adb1a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity37\"\nformat: \n  live-html:\n    theme:\n      light: [lux, theme-light.scss]\n      dark: [superhero, theme-dark.scss] \nengine: knitr\ntoc: true\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n\n#### **Modeling Inflation Dynamics**  \n\nWhen modeling inflation ($\\pi_t$) with GDP growth added to the framework, the relationship becomes:  \n$$\\pi_t = \\beta_0 + \\beta_1 \\text{Unemployment}_t + \\beta_2 \\text{CPI}_{t-1} + \\beta_3 \\text{GDP\\_growth}_t + \\epsilon_t$$  \nHere, GDP growth introduces another dimension of macroeconomic dynamics, as rising output ($\\text{GDP\\_growth}$) may signal demand-pull inflationary pressures, while unemployment ($\\text{Unemployment}_t$) and lagged CPI ($\\text{CPI}_{t-1}$) capture labor market slack and inertial price effects. However, structural breaks—such as shifts in productivity regimes, fiscal/monetary policy pivots, or global supply chain disruptions—can alter the **sign**, **magnitude**, or **significance** of these relationships over time.  \n\n1. **Detect breaks in all coefficients**: Extend the Chow test to identify shifts in $\\beta_1$ (unemployment’s impact), $\\beta_2$ (CPI persistence), *and* $\\beta_3$ (GDP growth sensitivity). For example, a break in $\\beta_3$ might reflect a transition from a high-growth, high-inflation era to a stagflationary regime.  \n2. **Segmented regression with regime-specific GDP effects**: Estimate $$Y_t = \\beta_0^{(k)} + \\beta_1^{(k)}\\text{Unemployment}_t + \\beta_2^{(k)}\\text{CPI}_{t-1} + \\beta_3^{(k)}\\text{GDP\\_growth}_t + \\epsilon_t^{(k)}$$ for each regime $k$. This reveals whether GDP growth amplifies inflation in certain eras (e.g., post-recession recoveries) but not others (e.g., during secular stagnation).  \n3. **STL decomposition**: Separate the trend component of inflation to distinguish whether GDP-driven fluctuations are cyclical (e.g., business cycle upswings) or structural (e.g., sustained growth-inflation linkages post-break).  \n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\ngetSymbols(\"CPIAUCSL\", src = \"FRED\", auto.assign = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"CPIAUCSL\"\n```\n\n\n:::\n\n```{.r .cell-code}\ncpi_data <- tibble(date = index(CPIAUCSL), CPI = as.numeric(CPIAUCSL[,1])) %>%\n  arrange(date) %>%\n  mutate(inflation = 100 * (CPI / lag(CPI) - 1)) %>%\n  mutate(Quarter = yearquarter(date)) %>% \n  as_tsibble(index = date) %>% \n  index_by(Quarter) %>% \n    summarize(CPI = mean(CPI),\n              inflation = mean(inflation))\n\n# Get US unemployment (monthly)\ngetSymbols(\"UNRATE\", src = \"FRED\", auto.assign = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"UNRATE\"\n```\n\n\n:::\n\n```{.r .cell-code}\nus_unemp <- data.frame(date = index(UNRATE), \n                      Unemployment = as.numeric(UNRATE$UNRATE)) %>%\n  as_tsibble(index = date) %>% \n  mutate(Quarter = yearquarter(date)) %>% \n  index_by(Quarter) %>% \n    summarize(Unemployment = mean(Unemployment))\n\n\n# Get US GDP (quarterly) and merge\ngetSymbols(\"GDP\", src = \"FRED\", auto.assign = TRUE)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"GDP\"\n```\n\n\n:::\n\n```{.r .cell-code}\nus_gdp <- data.frame(date = index(GDP), GDP = as.numeric(GDP$GDP)) %>%\n  as_tsibble(index = date) %>% \n  mutate(Quarter = yearquarter(date))\n\ncombined_data <- us_gdp %>% \n  inner_join(us_unemp, by = \"Quarter\") %>% \n  inner_join(cpi_data, by = \"Quarter\") %>% \n  mutate(GDP_growth = 100 * (GDP / lag(GDP) - 1)) %>% \n  dplyr::select(Quarter, date, GDP, GDP_growth, Unemployment, CPI, inflation) %>% \n  drop_na()\n\n# View the combined data\nhead(combined_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n# A tsibble: 6 x 7 [1D] <UTC>\n  Quarter date         GDP GDP_growth Unemployment   CPI inflation\n    <qtr> <date>     <dbl>      <dbl>        <dbl> <dbl>     <dbl>\n1 1948 Q2 1948-04-01  273.      2.57          3.67  24.0    0.914 \n2 1948 Q3 1948-07-01  279.      2.43          3.77  24.4    0.291 \n3 1948 Q4 1948-10-01  280.      0.419         3.83  24.2   -0.426 \n4 1949 Q1 1949-01-01  275.     -1.90          4.67  23.9   -0.194 \n5 1949 Q2 1949-04-01  271.     -1.34          5.87  23.9    0.0139\n6 1949 Q3 1949-07-01  273.      0.567         6.7   23.7   -0.236 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Chow test for structural breaks\nbreak_test <- Fstats(inflation ~ GDP_growth + Unemployment + CPI, data = combined_data)\nplot(break_test)  # Identify potential breakpoints\n```\n\n::: {.cell-output-display}\n![](activity37_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# Estimate breakpoint date(s)\nbp <- breakpoints(inflation ~  GDP_growth + Unemployment + CPI, data = combined_data)\n\ncombined_data$Quarter[bp$breakpoints] \n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n<yearquarter[1]>\n[1] \"1981 Q3\"\n# Year starts on: January\n```\n\n\n:::\n\n```{.r .cell-code}\n# Fit segmented regression\nsegmented_model <- lm(inflation ~ GDP_growth + Unemployment + CPI, \n                      data = combined_data, \n                      subset = breakpoints(bp)$breakpoints)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Get breakpoint indices \nbp_indices <- bp$breakpoints \n\n# Split data into segments\nsegments <- split(combined_data, \n                 findInterval(1:nrow(combined_data), \n                              vec = c(0, bp_indices, nrow(combined_data))))\n\n# Fit models to each segment\nsegment_models <- lapply(segments, function(df) {\n  lm(inflation ~ GDP_growth + Unemployment + CPI, data = df)\n})\n\n# Combine residuals from all segments\nall_residuals <- unlist(lapply(segment_models, residuals))\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Plot segmented regressions\nggplot(combined_data, aes(y =inflation, x=Quarter)) +\n  geom_point() +\n  geom_smooth(data = segments[[1]], method = \"lm\", se = FALSE, color = \"red\") +\n  geom_smooth(data = segments[[2]], method = \"lm\", se = FALSE, color = \"blue\") \n```\n\n::: {.cell-output-display}\n![](activity37_files/figure-html/unnamed-chunk-6-1.png){width=672}\n:::\n\n```{.r .cell-code}\n  labs(title = \"Segmented Regression by Breakpoints\")\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$title\n[1] \"Segmented Regression by Breakpoints\"\n\nattr(,\"class\")\n[1] \"labels\"\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# Inflation analysis\ncombined_data %>%\n  as_tsibble(index = Quarter) %>%\n  model(STL(inflation ~ trend() + season())) %>%\n  components() %>%\n  autoplot() + labs(title = \"Inflation Decomposition (STL)\")\n```\n\n::: {.cell-output-display}\n![](activity37_files/figure-html/unnamed-chunk-7-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nlapply(segment_models, summary)  # Show coefficients for each regime\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n$`1`\n\nCall:\nlm(formula = inflation ~ GDP_growth + Unemployment + CPI, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-0.54820 -0.13847 -0.02989  0.09587  0.82094 \n\nCoefficients:\n              Estimate Std. Error t value Pr(>|t|)    \n(Intercept)  -0.058009   0.075275  -0.771  0.44234    \nGDP_growth    0.043044   0.014900   2.889  0.00454 ** \nUnemployment -0.065806   0.016283  -4.041 9.08e-05 ***\nCPI           0.017150   0.001512  11.344  < 2e-16 ***\n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.219 on 129 degrees of freedom\nMultiple R-squared:  0.5898,\tAdjusted R-squared:  0.5802 \nF-statistic: 61.82 on 3 and 129 DF,  p-value: < 2.2e-16\n\n\n$`2`\n\nCall:\nlm(formula = inflation ~ GDP_growth + Unemployment + CPI, data = df)\n\nResiduals:\n     Min       1Q   Median       3Q      Max \n-1.13994 -0.09999 -0.00866  0.07742  0.59785 \n\nCoefficients:\n               Estimate Std. Error t value Pr(>|t|)    \n(Intercept)   0.2451342  0.0946348   2.590   0.0104 *  \nGDP_growth    0.0731280  0.0128770   5.679  5.8e-08 ***\nUnemployment -0.0057675  0.0089472  -0.645   0.5200    \nCPI          -0.0003466  0.0002783  -1.245   0.2148    \n---\nSignif. codes:  0 '***' 0.001 '**' 0.01 '*' 0.05 '.' 0.1 ' ' 1\n\nResidual standard error: 0.1956 on 169 degrees of freedom\nMultiple R-squared:  0.1874,\tAdjusted R-squared:  0.173 \nF-statistic: 12.99 on 3 and 169 DF,  p-value: 1.118e-07\n\n\n$`3`\n\nCall:\nlm(formula = inflation ~ GDP_growth + Unemployment + CPI, data = df)\n\nResiduals:\nALL 1 residuals are 0: no residual degrees of freedom!\n\nCoefficients: (3 not defined because of singularities)\n             Estimate Std. Error t value Pr(>|t|)\n(Intercept)    0.2905        NaN     NaN      NaN\nGDP_growth         NA         NA      NA       NA\nUnemployment       NA         NA      NA       NA\nCPI                NA         NA      NA       NA\n\nResidual standard error: NaN on 0 degrees of freedom\n```\n\n\n:::\n:::\n\n\n\n\n\n### **Activities** \n\n#### **Parameter Stability Assessment**\n\n**Q1: Test if the employment-inflation relationship remains stable using recursive residuals**\n\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(dynlm)\nrolling_residuals <- efp(inflation ~ GDP_growth  + Unemployment + CPI, data = combined_data, type = \"Rec-CUSUM\")\n\n# Plot and interpret:\nplot(rolling_residuals)\nabline(h = 1.358, lty = 2)  # 95% significance boundary\n```\n\n::: {.cell-output-display}\n![](activity37_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n\n\n\n**Task**: Explain what crossing the dashed line implies about parameter stability. How does this complement the Chow test results?\n\n---\n\n#### **Time-Varying Volatility Analysis**\n\n**Q2: Model volatility changes using GARCH(1,1)**\n\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(rugarch)\ngarch_spec <- ugarchspec(variance.model = list(model = \"sGARCH\", garchOrder = c(1,1)),\n                         mean.model = list(armaOrder = c(1,1)))\n\ngarch_fit <- ugarchfit(garch_spec, data = combined_data$inflation)\n\n# Plot conditional volatility\nplot(garch_fit, which = 3)\n```\n\n::: {.cell-output-display}\n![](activity37_files/figure-html/unnamed-chunk-10-1.png){width=672}\n:::\n:::\n\n\n\n**Task**: Identify periods of high volatility clustering. Could these coincide with structural breaks in mean relationships?\n\n\n\n#### **Rolling Window Analysis**\n\n**# Q3: Calculate 5-year rolling correlations**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(slider)\ncombined_data <- combined_data %>%\n  mutate(\n    rolling_cor = slide_dbl(\n      .x = cur_data(),\n      .f = ~ cor(.x$inflation, .x$Unemployment),\n      .before = 60  # 5-year window\n    )\n  )\n\n# Visualize\nggplot(combined_data, aes(Quarter, rolling_cor)) +\n  geom_line() +\n  geom_hline(yintercept = 0, linetype = \"dashed\")\n```\n\n::: {.cell-output-display}\n![](activity37_files/figure-html/unnamed-chunk-11-1.png){width=672}\n:::\n:::\n\n\n\n**Task**: When does employment become negatively correlated with inflation? How does this relate to Phillips curve theory? The **Phillips Curve** is an economic theory describing an inverse relationship between unemployment and inflation, first observed by A.W. Phillips (1958) using UK wage data.\n",
    "supporting": [
      "activity37_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
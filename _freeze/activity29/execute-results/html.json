{
  "hash": "4b8f127a60fa4e4587413ae1c8546c81",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity29\"\nformat: \n  live-html:\n    theme:\n      light: [lux, theme-light.scss]\n      dark: [superhero, theme-dark.scss] \nengine: knitr\ntoc: true\n---\n\n::: {.cell}\n\n:::\n\n\n\n::: {.cell}\n\n:::\n\n## Introduction to State-space Models  \n\n### 1. Core Concept: The Hidden Layer of Time Series\n\n**Why State-Space?** ARIMA models directly relate past observations to present values. State-space models add a hidden layer that evolves independently:\n\n**Simple Weather Example**  \n\n- *Observed:* Daily temperature ($y_t$)  \n- *Hidden State:* Atmospheric pressure system ($x_t$)  \n- *Relationship:*  \n  Pressure evolves: $x_t = 0.9x_{t-1} + \\text{weather\\_disturbance}$  \n  We observe: $y_t = x_t + \\text{thermometer\\_error}$  \n\n**Model Equations**  \n\nState Transition:  \n\n$$x_t = \\phi x_{t-1} + w_t \\quad (\\text{Memory factor } \\phi, \\text{ system noise } w_t)$$  \n\nObservation Process:  \n\n$$y_t = x_t + v_t \\quad (\\text{Measurement noise } v_t)$$  \n\n### 2. Retail Inventory Analysis\n\n::: {.cell}\n```{webr}\nus_retail <- us_employment %>%\n  filter(Series_ID == \"CEU0800000001\") %>% \n  mutate(Employed = Employed/1e3)  # Thousands of employees\n\n# Fit basic state-space model\nfit <- us_retail %>%\n  model(ETS(Employed ~ error(\"A\") + trend(\"Ad\") + season(\"N\"))) \n\n# Model output\nfit %>% report()\n\n# Extract hidden components\ncomponents(fit) %>% autoplot()\n```\n:::\n\n**Interpretation**:  \n\n- *Level*: Long-term employment capacity  \n- *Trend*: Damped growth pattern (Ad = additive damped)  \n- *Noise*: Irregular fluctuations ($v_t$ in our equations)\n\n**State Transition Equations**:  \n\n- **Level**:  \n\n  $$\n  l_t = l_{t-1} + \\phi b_{t-1} + \\alpha \\epsilon_t \\quad \\Rightarrow \\quad l_t = l_{t-1} + 0.98b_{t-1} + 0.9999\\epsilon_t\n  $$  \n  \n- **Damped Trend**:  \n\n  $$\n  b_t = \\phi b_{t-1} + \\beta \\epsilon_t \\quad \\Rightarrow \\quad b_t = 0.98b_{t-1} + 0.0162\\epsilon_t\n  $$  \n\n**Observation Equation**:  \n\n$$\ny_t = l_{t-1} + \\phi b_{t-1} + \\epsilon_t \\quad \\Rightarrow \\quad y_t = l_{t-1} + 0.98b_{t-1} + \\epsilon_t\n$$  \n\n\n### 3. Activity: Employment Dynamics\n\n**Step 1 - Model Setup**  \n\n::: {.cell}\n```{webr}\nemployment_model <- us_retail %>%\n  model(SSM = ETS(Employed ~ error(\"A\") + trend(\"Ad\")))\nemployment_model %>% report()\n```\n:::\n\n**Step 2 - Extract States**  \n\n::: {.cell}\n```{webr}\nhidden_states <- components(employment_model) %>%\n  select(Month, level, slope) %>% \n  tidyr::drop_na()\n```\n:::\n\n**Step 3 - Equation Translation**  \n\nBased on the `ETS(A,Ad,A)` model output with parameters:  \n\n- **α** = 0.6488 (level smoothing)  \n- **β** = 0.1251 (trend smoothing)  \n- **φ** = 0.9794 (damping factor)  \n- **γ** = 0.3298 (seasonal smoothing)  \n\n#### **State Transition Equations**\n\n1. **Level**:  \n   $l_t = l_{t-1} + \\phi b_{t-1} + \\alpha \\epsilon_t$  \n   $\\Rightarrow l_t = l_{t-1} + 0.9794b_{t-1} + 0.6488\\epsilon_t$  \n\n2. **Damped Trend**:  \n   $b_t = \\phi b_{t-1} + \\beta \\epsilon_t'$  \n   $\\Rightarrow b_t = 0.9794b_{t-1} + 0.1251\\epsilon_t'$  \n\n3. **Seasonal Component**:  \n   $s_t = s_{t-m} + \\gamma \\epsilon_t''$  \n   $\\Rightarrow s_t = s_{t-12} + 0.3298\\epsilon_t''$ *(monthly seasonality: $m = 12$)*  \n\n#### **Observation Equation**  \n\n$y_t = l_{t-1} + \\phi b_{t-1} + s_{t-m} + v_t$  \n$\\Rightarrow y_t = l_{t-1} + 0.9794b_{t-1} + s_{t-12} + v_t$  \n\n\n### 4. Activity \n\n**Problem 1**: Fit damped trend model to `US_employment`  \n\n\n::: {.cell}\n```{webr}\nsolution <- us_employment %>%\n  filter(Series_ID == \"CEU0800000001\") %>%\n  model(ETS(Employed ~ error(\"A\") + trend(\"Ad\")))\n```\n:::\n\n\n**Problem 2**: Perform a residual diagnostics vs ARIMA  \n\n\n::: {.cell}\n```{webr}\n# State-space residuals\nsolution %>% residuals() %>% \n  gg_tsdisplay(.resid)\n\n# Compare with ARIMA\nus_employment %>%\n  filter(Series_ID == \"CEU0800000001\") %>%\n  model(ARIMA(Employed)) %>% \n  gg_tsresiduals()\n```\n:::\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
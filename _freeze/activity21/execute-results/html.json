{
  "hash": "67ec7815c09b2a544c9785c3e5e9e67a",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity21\"\nformat: live-html\nengine: knitr\ntoc: true\nwebr:\n  packages:\n    - dplyr\n    - ggplot2\n    - fpp3\n    - patchwork\n    - tsibbledata\n    - urca\n    - astsa\n    - gridExtra\n    - vars\nwarning: false\nmessage: false\n---\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\n\n\n\n# Theoretical Foundations of AR Models\n\n## **Time Series Nature & Stationarity**\n\nDefine AR($p$): $Y_t = \\phi_1 Y_{t-1} + \\dots + \\phi_p Y_{t-p} + \\epsilon_t$, $\\epsilon_t \\sim WN(0,\\sigma^2)$  \n\n\n**AR(p) Properties**:\n\n- Captures *temporal dependence* through lagged terms\n- PACF cuts off after lag $p$\n- Requires stationarity for reliable inference\n- Unit root non-stationarity occurs when characteristic equation $1 - \\phi_1 z - \\cdots - \\phi_p z^p = 0$ has roots *on* unit circle\n\n::: {.cell}\n::: {.cell-output-display}\n![](activity21_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fable)\nset.seed(123)\nar_data <- tibble(time = 1:100, y = arima.sim(model = list(ar = c(0.7, -0.2)), n = 100)) %>% \n  as_tsibble(index = time)\n\nar_data %>% \n  gg_tsdisplay(y, plot_type = c(\"scatter\")) + # ACF/PACF\n  labs(title = \"AR(2) Process: φ₁=0.7, φ₂=-0.2\")\n```\n\n::: {.cell-output-display}\n![](activity21_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n**Model Fitting & Diagnostics**  \n\n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ar <- ar_data %>% \n  model(ARIMA(y ~ pdq(2,0,0))) # Explicit AR specification\n\nreport(fit_ar) # Check coefficients & σ²\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: y \nModel: ARIMA(2,0,0) \n\nCoefficients:\n         ar1      ar2\n      0.6757  -0.1576\ns.e.  0.0990   0.1002\n\nsigma^2 estimated as 0.8167:  log likelihood=-130.99\nAIC=267.99   AICc=268.24   BIC=275.8\n```\n\n\n:::\n\n```{.r .cell-code}\nfit_ar %>% residuals() %>% gg_tsdisplay(plot_type = c(\"scatter\")) # Residual diagnostics\n```\n\n::: {.cell-output-display}\n![](activity21_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n## **Real-World Process: US Consumption**\n\nFrom the *global_economy* dataset (Ch. 5 of text), we'll analyze quarterly percentage changes in personal consumption expenditures (stationary series):\n\n\n### **Lab Activity A: AR Modeling with Real Data**\n\n::: {.cell}\n```{webr}\nlibrary(fpp3)\ndata(us_change)\nconsumption_ts <- us_change %>%\n  dplyr::select(Quarter, Consumption) %>%\n  as_tsibble(index = Quarter)\n```\n:::\n\n**Exploratory Analysis & Stationarity**\n\n1. **Visualize Series**:\n\n::: {.cell}\n```{webr}\nconsumption_ts %>%\n  autoplot(Consumption) +\n  labs(title = \"US Consumption Changes\", y = \"% Change\")\n```\n:::\n\n2. **Stationarity Assessment**:\n\n::: {.cell}\n```{webr}\nconsumption_ts %>%\n  features(Consumption, unitroot_kpss) # H0: Stationary\n\nconsumption_ts %>%\n  gg_tsdisplay(Consumption, plot_type = \"partial\")\n```\n:::\n\n**Model Fitting & Forecasting**\n\n1. **Fit AR Model**:\n\n::: {.cell}\n```{webr}\nar_fit <- consumption_ts %>%\n  model(ARIMA(Consumption ~ pdq() + PDQ(0,0,0)))\n\nreport(ar_fit) # Compare φ coefficients to simulation\n```\n:::\n\n2. **Residual Diagnostics**:\n\n::: {.cell}\n```{webr}\nar_fit %>%\n  residuals() %>%\n  gg_tsdisplay(.resid, plot_type = \"partial\") +\n  labs(title = \"Residual Diagnostics\")\n```\n:::\n\n3. **Forecasting**:\n\n::: {.cell}\n```{webr}\nar_fit %>%\n  forecast(h = 8) %>%\n  autoplot(consumption_ts) +\n  labs(title = \"2-Year Consumption Forecast\")\n```\n:::\n\n\n### **Lab Activity B: Real-World Application - US Income Changes**\n\n**1. Data Preparation & Visualization**\n\n::: {.cell}\n```{webr}\nincome_ts <- us_change %>%\n  dplyr::select(Quarter, Income) %>%\n  as_tsibble(index = Quarter)\n\nincome_ts %>%\n  autoplot(Income) +\n  labs(title = \"US Personal Income Growth Rate\", y = \"% Change\")\n```\n:::\n\n**2. Order Identification**  \n\nDetermine appropriate AR order through PACF:\n\n::: {.cell}\n```{webr}\nincome_ts %>%\n  gg_tsdisplay(Income, plot_type = \"partial\", lag_max = 25) +\n  labs(title = \"Income Series Diagnostics\")\n```\n:::\n\n\n**3. Model Comparison**  \n\nFit competing specifications and evaluate:\n\n::: {.cell}\n```{webr}\nincome_models <- income_ts %>%\n  model(\n    AR1 = ARIMA(Income ~ pdq(1,0,0)),\n    AR2 = ARIMA(Income ~ pdq(2,0,0)),\n    Auto = ARIMA(Income)\n  )\n\nglance(income_models) \ntidy(income_models)\n```\n:::\n\n\n**4. Forecasting & Policy Implications**  \n\nUsing the best model, generate forecasts up-to 10 time points into the future and interpret economic meaning:\n\n::: {.cell}\n```{webr}\nincome_models %>%\n  dplyr::select(Auto) %>%\n  forecast(h = 8) %>%\n  autoplot(income_ts) +\n  labs(title = \"2-Year Income Growth Forecast\",\n       subtitle = \"Auto Model Projection\")\n```\n:::\n\n",
    "supporting": [
      "activity21_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
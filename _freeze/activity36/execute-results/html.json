{
  "hash": "efd7634f1340e24ef3d19e8c4721fff6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity36\"\nformat: \n  live-html:\n    theme:\n      light: [lux, theme-light.scss]\n      dark: [superhero, theme-dark.scss] \nengine: knitr\ntoc: true\n---\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n:::\n\n\n\n## **Extending to Multiple Variables with Structural Breaks**\n\n**Data Prep: Australian Production (Beer, Gas, Electricity)**\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\nproduction_data <- aus_production %>%\n  dplyr::select(Quarter, Beer, Gas, Electricity) %>%\n  drop_na() %>%\n  mutate(across(c(Beer, Gas, Electricity), log))\n```\n:::\n\n\n\n\n### **Activity 1: Detecting Structural Breaks**  \n\n**Structural Break Detection**  \n\nUsing Chow test and CUSUM for regime shifts:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# 1. Visual break identification\nproduction_data %>%\n  pivot_longer(-Quarter) %>%\n  autoplot(value) + \n  geom_vline(\n    xintercept = as.numeric(yearquarter(\"1968 Q3\")),  \n    color = \"firebrick\", \n    linetype = 2\n  ) +\n  labs(title = \"Production Trends with Suspected Structural Break\")\n```\n\n::: {.cell-output-display}\n![](activity36_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n\n```{.r .cell-code}\n# 2. Formal breakpoints test\nlibrary(strucchange)\nbp_test <- Fstats(Beer ~ Gas + Electricity, data = production_data)\nbreak_date <- breakpoints(bp_test)$breakpoints %>%\n  production_data$Quarter[.]\n```\n:::\n\n\n\n**Handling Structural Breaks**  \n\nCreate intervention dummy:\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Create an intervention dummy: 0 before break, 1 after break\nproduction_data <- production_data %>%\n  mutate(regime = if_else(Quarter >= break_date, 1, 0))\n```\n:::\n\n\n\n### **Activity 2: ARIMA with an Intervention Dummy**\n\nIncorporating the intervention variable as an external regressor.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Fit ARIMA model with intervention dummy using xreg()\narima_model <- production_data %>%\n  model(ARIMA(Beer ~ xreg(regime)))\nreport(arima_model)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Beer \nModel: LM w/ ARIMA(3,0,1)(0,1,1)[4] errors \n\nCoefficients:\n         ar1     ar2     ar3      ma1     sma1   regime\n      0.4114  0.3476  0.2172  -0.3827  -0.7269  -0.0156\ns.e.  0.1396  0.0774  0.1078   0.1339   0.0541   0.0216\n\nsigma^2 estimated as 0.001226:  log likelihood=415.13\nAIC=-816.25   AICc=-815.71   BIC=-792.69\n```\n\n\n:::\n:::\n\n\n\nThe underlying model is represented as\n\n$$\n\\begin{align}\ny_t &= \\mu + \\sum_{i=1}^{p}\\phi_i y_{t-i} + \\sum_{j=1}^{q}\\theta_j \\epsilon_{t-j} + \\beta D_t + \\epsilon_t,\n\\end{align}\n$$\n\nwhere $D_t$ is defined as\n\n$$\nD_t =\n\\begin{cases}\n0, & t < \\text{break date}, \\\\\n1, & t \\geq \\text{break date},\n\\end{cases}\n$$\n\n### **Activity 3: ETS Models on Regime-Split Data**\n\nSince ETS models do not natively accept exogenous regressors, we split the data into pre- and post-break regimes and fit separate ETS models.\n\n\n\n::: {.cell}\n\n```{.r .cell-code}\n# Split the data based on break_date\ndata_pre_break <- production_data %>% filter(Quarter < break_date)\ndata_post_break <- production_data %>% filter(Quarter >= break_date)\n\n# Fit ETS models for Beer production on each regime\nets_pre <- data_pre_break %>% model(ETS(Gas))\nets_post <- data_post_break %>% model(ETS(Gas))\n\n# Output summaries\nreport(ets_pre)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Gas \nModel: ETS(M,Ad,M) \n  Smoothing parameters:\n    alpha = 0.01881967 \n    beta  = 0.0002899828 \n    gamma = 0.0001000133 \n    phi   = 0.9655274 \n\n  Initial states:\n     l[0]       b[0]      s[0]    s[-1]   s[-2]     s[-3]\n 1.738852 0.01357626 0.9695589 1.087424 1.04629 0.8967272\n\n  sigma^2:  7e-04\n\n      AIC      AICc       BIC \n-90.56723 -84.92621 -71.44700 \n```\n\n\n:::\n\n```{.r .cell-code}\nreport(ets_post)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: Gas \nModel: ETS(A,Ad,A) \n  Smoothing parameters:\n    alpha = 0.9259609 \n    beta  = 0.003951867 \n    gamma = 0.06488783 \n    phi   = 0.964834 \n\n  Initial states:\n     l[0]      b[0]       s[0]      s[-1]       s[-2]    s[-3]\n 2.152093 0.1157745 0.04439275 -0.1586937 -0.05726503 0.171566\n\n  sigma^2:  0.002\n\n      AIC      AICc       BIC \n-173.9162 -172.5149 -142.6765 \n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nets_pre %>%\n  components() %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](activity36_files/figure-html/unnamed-chunk-8-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nets_post %>% \n  components() %>% \n  autoplot()\n```\n\n::: {.cell-output-display}\n![](activity36_files/figure-html/unnamed-chunk-9-1.png){width=672}\n:::\n:::\n",
    "supporting": [
      "activity36_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
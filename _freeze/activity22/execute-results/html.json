{
  "hash": "c3baeaa4fd5eefabe32bccdb1fd19be9",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity22\"\nformat: html\nengine: knitr\ntoc: true\nwebr:\n  packages:\n    - dplyr\n    - ggplot2\n    - fpp3\n    - patchwork\n    - tsibbledata\n    - urca\n    - astsa\n    - gridExtra\n    - vars\nwarning: false\nmessage: false\n---\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\n\n**Theoretical Foundations of MA Processes**\n\n## **Time Series Nature & Invertibility**\n\n**Definition**:  \n\nMA($q$) model:  \n$Y_t = \\epsilon_t + \\theta_1 \\epsilon_{t-1} + \\cdots + \\theta_q \\epsilon_{t-q}$  \nwhere $\\epsilon_t \\sim WN(0,\\sigma^2)$  \n\n**Key Properties**:  \n\n- Models *shock persistence* through lagged errors  \n- ACF cuts off after lag $q$ (distinct signature)  \n- PACF tails off gradually  \n- Requires **invertibility** (roots of $1 + \\theta_1 z + \\cdots + \\theta_q z^q = 0$ lie **outside** unit circle)  \n\n---\n\n## **Simulating & Diagnosing MA Processes**\n\n### **Simulated MA(2) Process**  \n\n::: {.cell}\n\n```{.r .cell-code}\nlibrary(fable)\nset.seed(123)\nma_data <- tibble(\n  time = 1:100,\n  y = arima.sim(model = list(ma = c(0.5, -0.3)), n = 100) # θ₁=0.5, θ₂=-0.3\n) %>% as_tsibble(index = time)\n\nma_data %>% \n  gg_tsdisplay(y, plot_type = \"scatter\") + # Observe ACF cutoff at lag 2\n  labs(title = \"Simulated MA(2): θ₁=0.5, θ₂=-0.3\")\n```\n\n::: {.cell-output-display}\n![](activity22_files/figure-html/unnamed-chunk-3-1.png){width=672}\n:::\n:::\n\n### **Model Estimation & Diagnostics**  \n\n::: {.cell}\n\n```{.r .cell-code}\nfit_ma <- ma_data %>% \n  model(ARIMA(y ~ pdq(0,0,2))) # Explicit MA(2) specification\n\nreport(fit_ma) # Check θ estimates vs true values (0.5, -0.3)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nSeries: y \nModel: ARIMA(0,0,2) \n\nCoefficients:\n         ma1      ma2\n      0.5477  -0.3881\ns.e.  0.0911   0.0908\n\nsigma^2 estimated as 0.8128:  log likelihood=-131.49\nAIC=268.98   AICc=269.23   BIC=276.8\n```\n\n\n:::\n\n```{.r .cell-code}\nfit_ma %>% \n  residuals() %>% \n  gg_tsdisplay(plot_type = \"scatter\") + \n  labs(title = \"MA(2) Residual Diagnostics\")\n```\n\n::: {.cell-output-display}\n![](activity22_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n---\n\n## **Real-World Case Study: US Consumption**\n\n### **Lab Activity A: Modeling Consumption with MA**\n\n**1. Data Preparation**  \n\n::: {.cell}\n```{webr}\nlibrary(fpp3)\ndata(us_change)\nconsumption_ts <- us_change %>%\n  dplyr::select(Quarter, Consumption) %>%\n  as_tsibble(index = Quarter)\n```\n:::\n\n**2. Exploratory Analysis** \n\n::: {.cell}\n```{webr}\nconsumption_ts %>%\n  autoplot(Consumption) +\n  labs(title = \"US Consumption Growth Rate\", y = \"% Change\")\n```\n:::\n\n**3. MA Order Identification**  \n\n::: {.cell}\n```{webr}\nconsumption_ts %>%\n  gg_tsdisplay(Consumption, plot_type = \"partial\", lag_max = 8) + \n  labs(title = \"ACF Shows Sharp Cutoff at Lag 3 → MA(3) Candidate\")\n```\n:::\n\n**4. Model Fitting**  \n\n::: {.cell}\n```{webr}\nma_fit <- consumption_ts %>%\n  model(\n    MA3 = ARIMA(Consumption ~ pdq(0,0,3)),\n    Auto = ARIMA(Consumption) # Auto-detected MA/SARIMA\n  )\n\nglance(ma_fit) %>% arrange(AICc) # Compare models\nreport(ma_fit %>% dplyr::select(MA3)) # Show θ coefficients\n```\n:::\n\n**5. Residual Diagnostics**  \n\n::: {.cell}\n```{webr}\nma_fit %>% \n  dplyr::select(MA3) %>% \n  residuals() %>% \n  gg_tsdisplay(.resid, plot_type = \"partial\") +\n  labs(title = \"MA(3) Residuals: No Significant Autocorrelation\")\n```\n:::\n\n**6. Forecasting**  \n\n::: {.cell}\n```{webr}\nma_fit %>%\n  dplyr::select(MA3) %>%\n  forecast(h = 8) %>% \n  autoplot(consumption_ts) +\n  labs(title = \"2-Year Consumption Forecast Using MA(3)\")\n```\n:::\n\n---\n\n## **Lab Activity B: Modeling US Production**\n\n**1. Data Preparation**  \n\n::: {.cell}\n```{webr}\nproduction_ts <- us_change %>%\n  dplyr::select(Quarter, Production) %>%\n  as_tsibble(index = Quarter)\n```\n:::\n\n**2. Visualize Series**  \n\n::: {.cell}\n```{webr}\nproduction_ts %>%\n  autoplot(Production) +\n  labs(title = \"US Industrial Production Growth\", y = \"% Change\")\n```\n:::\n\n**3. MA Order Selection**  \n\nDetermine appropriate MA order through ACF:\n\n\n::: {.cell}\n```{webr}\nproduction_ts %>%\n  gg_tsdisplay(Production, plot_type = \"partial\", lag_max = 8) + \n  labs(title = \"ACF Suggests MA(1) Structure\")\n```\n:::\n\n\n**4. Model Comparison**  \n\nFit competing specifications and evaluate:\n\n\n::: {.cell}\n```{webr}\nprod_models <- production_ts %>%\n  model(\n    MA1 = ARIMA(Production ~ pdq(0,0,1) + PDQ(0,0,0)),\n    MA3 = ARIMA(Production ~ pdq(0,0,3) + PDQ(0,0,0)),\n    Auto = ARIMA(Production)\n  )\n\nglance(prod_models) %>% arrange(AICc) \nreport(prod_models %>% dplyr::select(MA3))\n```\n:::\n\n\n**5. Policy-Relevant Forecasting**  \n\nUsing the best model, generate forecasts up-to 10 time points into the future and interpret economic meaning:\n\n\n::: {.cell}\n```{webr}\nprod_models %>%\n  dplyr::select(MA3) %>%\n  forecast(h = 8) %>%\n  autoplot(production_ts) +\n  labs(title = \"Production Growth Forecast\",\n       subtitle = \"MA(3) Model\")\n```\n:::\n\n\n\n## **Key Concepts Cheat Sheet**\n\n| Feature        | MA($q$)                          | Contrast with AR($p$)              |\n|----------------|----------------------------------|------------------------------------|\n| **ACF**        | Cuts off at lag $q$              | Tails off gradually                |\n| **PACF**       | Tails off gradually              | Cuts off at lag $p$                |\n| **Condition**  | Invertibility (roots > 1)        | Stationarity (roots < 1)           |\n| **Use Case**   | Short-lived shock effects        | Long-term dependencies             |\n\n\n\n",
    "supporting": [
      "activity22_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}
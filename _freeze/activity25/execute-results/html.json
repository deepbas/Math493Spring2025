{
  "hash": "a07eafa8963c43e3ff10cdbef5e5a4c6",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Activity25\"\nformat: live-html\nengine: knitr\ntoc: true\nwebr:\n  packages:\n    - dplyr\n    - ggplot2\n    - fpp3\n    - patchwork\n    - tsibbledata\n    - urca\n    - astsa\n    - gridExtra\n    - vars\nwarning: false\nmessage: false\n---\n\n::: {.cell}\n\n:::\n\n\n::: {.cell}\n\n:::\n\n\n**Theoretical Background: ARIMA($p,d,q$)($P,D,Q$)[$s$] Model Interpretations**\n\n### 1. Autoregressive (AR) Model\n\nAn AR(1) model predicts the current value from its immediately preceding value. In its simplest form, it is written as\n\n$$\ny_t = c + \\phi_1\\,y_{t-1} + \\varepsilon_t,\n$$\n\nwhere  \n- $y_t$ is the observed value at time $t$,  \n- $c$ is a constant (or drift),  \n- $\\phi_1$ is the AR coefficient, and  \n- $\\varepsilon_t$ is the error (white noise) at time $t$.\n\n\n\n### 2. Moving Average (MA) Component\n\nAn MA(1) model expresses the current value as a function of the current and one past error term:\n\n$$\ny_t = c + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1},\n$$\n\nwhere $\\theta_1$ is the MA coefficient. This shows that the noise from the previous period also influences the current observation.\n\n\n\n### 3. Combine Them into an ARMA Model\n\nWhen both AR and MA parts are included, we have an ARMA(1,1) model:\n\n$$\ny_t = c + \\phi_1\\,y_{t-1} + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1}.\n$$\n\nThis model now explains the series using both its past values and past errors.\n\n\n\n### 4. Incorporate Differencing to Remove Trends\n\nIf the original series is nonstationary (for example, it has a trend), we apply differencing. A first difference is defined as\n\n$$\n\\Delta y_t = y_t - y_{t-1}.\n$$\n\nNow, you model the differenced series rather than the original series. For instance, an ARMA(1,1) model on the differenced data becomes\n\n$$\n\\Delta y_t = c + \\phi_1\\,\\Delta y_{t-1} + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1}.\n$$\n\nThis step removes linear trends and stabilizes the mean of the series.\n\n\n\n### 5. Add Seasonality with Seasonal Differencing\n\nSeasonal patterns can be removed by seasonal differencing. For example, if your data shows a weekly pattern (period $s=7$), the seasonal difference is\n\n$$\n\\Delta_7 y_t = y_t - y_{t-7}.\n$$\n\nIf seasonality is also modeled through seasonal AR or MA terms, you can add these effects after differencing.\n\n\n### 6. Build a Multiplicative Seasonal ARIMA Model\n\nA full seasonal ARIMA model is usually denoted as ARIMA($p,d,q$)($P,D,Q$)[$s$], which combines:\n\n- **Nonseasonal components:** AR($p$), differencing $d$, and MA($q$).\n- **Seasonal components:** Seasonal AR($P$), seasonal differencing $D$, and seasonal MA($Q$) with period $s$.\n\nA simplified way to “build up” the full model in one long equation is as follows:\n\n> **Step A:** Apply nonseasonal differencing (order $d$) and seasonal differencing (order $D$ at period $s$). Denote the fully differenced series as\n> \n> $$\n> z_t = \\Delta^d\\,\\Delta_s^D y_t.\n> $$\n\n> **Step B:** Model $z_t$ with nonseasonal AR and MA parts:\n> \n> $$\n> z_t = c + \\phi_1\\,z_{t-1} + \\cdots + \\phi_p\\,z_{t-p} + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1} + \\cdots + \\theta_q\\,\\varepsilon_{t-q}.\n> $$\n\n> **Step C:** Add the seasonal components. For a seasonal AR($P$) and MA($Q$) (applied to the same differenced series), include:\n> \n> $$\n> -\\,\\Phi_1\\,z_{t-s} - \\cdots - \\Phi_P\\,z_{t-Ps}\n> $$\n> \n> on the AR side and\n> \n> $$\n> -\\,\\Theta_1\\,\\varepsilon_{t-s} - \\cdots - \\Theta_Q\\,\\varepsilon_{t-Qs}\n> $$\n> \n> on the MA side.\n\n> **Step D:** Combine the pieces into one sequential equation:\n\n$$\n\\begin{aligned}\nz_t &= c \\\\\n&\\quad + \\underbrace{\\phi_1\\,z_{t-1} + \\cdots + \\phi_p\\,z_{t-p}}_{\\text{Nonseasonal AR terms}} \\\\\n&\\quad - \\underbrace{\\Phi_1\\,z_{t-s} + \\cdots + \\Phi_P\\,z_{t-Ps}}_{\\text{Seasonal AR terms}} \\\\\n&\\quad + \\varepsilon_t \\\\\n&\\quad + \\underbrace{\\theta_1\\,\\varepsilon_{t-1} + \\cdots + \\theta_q\\,\\varepsilon_{t-q}}_{\\text{Nonseasonal MA terms}} \\\\\n&\\quad - \\underbrace{\\Theta_1\\,\\varepsilon_{t-s} + \\cdots + \\Theta_Q\\,\\varepsilon_{t-Qs}}_{\\text{Seasonal MA terms}}.\n\\end{aligned}\n$$\n\nHere, $z_t$ represents the series after both nonseasonal and seasonal differencing. This equation is a conceptual “blueprint” that shows how each modeling component is added sequentially.\n\n---\n\n## Example Configurations\n\n### ARIMA(1,1,1) with Drift (Nonseasonal)\n\nIn this configuration, we first remove trends by differencing the series, then model the differenced series with one AR term and one MA term.\n\n1. **Nonseasonal Differencing:**\n   $$\n   \\begin{aligned}\n   \\Delta y_t = y_t - y_{t-1}.\n   \\end{aligned}\n   $$\n\n2. **Modeling the Differenced Series:**\n   $$\n   \\begin{aligned}\n   \\Delta y_t &= c + \\phi_1\\,\\Delta y_{t-1} + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1}.\n   \\end{aligned}\n   $$\n\n**Key Points:**\n- The first difference $\\Delta y_t$ helps stabilize the mean.\n- $\\phi_1$ captures the autoregressive effect on the differenced data.\n- $\\theta_1$ models the influence of the previous error.\n\n---\n\n### ARIMA(1,0,1)(0,1,1)[4] with Drift (Seasonal)\n\nThis model introduces seasonal differencing with period 4 and includes nonseasonal AR(1) and MA(1) terms along with a seasonal MA(1) component.\n\n1. **Seasonal Differencing:**\n   $$\n   \\begin{aligned}\n   \\Delta_4 y_t = y_t - y_{t-4}.\n   \\end{aligned}\n   $$\n\n2. **Sequentially Building the Model:**\n   $$\n   \\begin{aligned}\n   y_t - y_{t-4} &= c + \\phi_1\\,\\Bigl[(y_{t-1} - y_{t-5})\\Bigr] + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1} - \\Theta_1\\,\\varepsilon_{t-4}.\n   \\end{aligned}\n   $$\n\n**Key Points:**\n\n- Seasonal differencing ($y_t - y_{t-4}$) removes periodic effects.\n- $\\phi_1$ is the nonseasonal AR term applied to the lagged (but also seasonally adjusted) data.\n- $\\theta_1$ is the nonseasonal MA term.\n- $\\Theta_1$ is the seasonal MA term that adjusts the error from one season ago.\n- $c$ is the drift.\n\n---\n\n## Practice Configurations \n\n### Practice Problem 1\n\n**Problem:** Write the sequential equation for a simple AR(1) model with drift.\n\n**Answer:**\n\n$$\n\\begin{aligned}\ny_t &= c + \\phi_1\\,y_{t-1} + \\varepsilon_t.\n\\end{aligned}\n$$\n\n\n### Practice Problem 2\n\n**Problem:** Write the sequential equation for an ARIMA(0,1,1) model with drift—that is, first-difference the series and then apply an MA(1) model.\n\n\n**Answer:**\n\n1. **Differencing:**\n   $$\n   \\begin{aligned}\n   \\Delta y_t = y_t - y_{t-1}.\n   \\end{aligned}\n   $$\n\n2. **Model Equation:**\n   $$\n   \\begin{aligned}\n   y_t - y_{t-1} &= c + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1}.\n   \\end{aligned}\n   $$\n\n\n### Practice Problem 3\n\n**Problem:** Write the sequential equation for a seasonal ARIMA(0,1,1)(1,0,0)[12] model with drift.  \n*(Hint: This model applies nonseasonal differencing and includes a seasonal AR(1) component with period 12 along with a nonseasonal MA(1) term.)*\n\n**Answer:**\n\n1. **Nonseasonal Differencing:**\n   $$\n   \\begin{aligned}\n   \\Delta y_t = y_t - y_{t-1}.\n   \\end{aligned}\n   $$\n\n2. **Incorporate Seasonal AR(1):**\n   $$\n   \\begin{aligned}\n   (y_t - y_{t-1}) - \\Phi_1\\,(y_{t-12} - y_{t-13}) &= c + \\varepsilon_t + \\theta_1\\,\\varepsilon_{t-1}.\n   \\end{aligned}\n   $$\n\n**Key Points:**\n\n- $\\Phi_1$ is the seasonal AR coefficient with period 12.\n- $\\theta_1$ is the nonseasonal MA coefficient.\n- The left-hand side shows the nonseasonally differenced data adjusted by the seasonal AR component.\n\n\n",
    "supporting": [],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}